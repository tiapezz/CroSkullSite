{"ast":null,"code":"import _regeneratorRuntime from \"F:\\\\Mattia\\\\Visual studio\\\\AppCroskull\\\\croskull-nft-marketplace\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/regenerator\";\nimport _asyncToGenerator from \"F:\\\\Mattia\\\\Visual studio\\\\AppCroskull\\\\croskull-nft-marketplace\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";\n// constants\nimport { ethers } from 'ethers'; // log\n\nimport CroSkullsAmbassador from \"../../abis/CroSkullsAmbassador.json\";\nimport CroSkulls from \"../../abis/CroSkulls.json\";\nimport StakingArtifacts from \"../../abis/croSkullStaking.json\";\nimport Grave from \"../../abis/Grave.json\";\nimport Description from \"../../abis/nftDescription.json\";\nimport BluePotion from \"../../abis/CroSkullsBluePotions.json\";\nimport RedPotion from \"../../abis/CroSkullsRedPotions.json\";\nimport PetEggs from \"../../abis/petEggs.json\";\nimport Souls from \"../../abis/Souls.json\";\nimport Raffle from \"../../abis/SkullsRaffle.json\";\nimport { sendNotification, getSkullsData, cleanData } from \"../data/dataActions\";\nvar chainId = \"0x19\" || \"0x152\"; //testnet - 3\n\nvar networkId = 25; //338 || 5777; //25 production, 339 cassini, 5777 ganache local env\n\nvar stakingAddress = StakingArtifacts.networks[networkId].address;\nvar graveAddress = Grave.networks[networkId].address;\nvar ContractAddress = CroSkulls.networks[networkId].address;\nvar descriptionAddress = Description.networks[networkId].address;\nvar petEggsAddress = PetEggs.networks[networkId].address;\nvar soulsAddress = Souls.networks[networkId].address;\nvar blueAddress = BluePotion.networks[networkId].address;\nvar redAddress = RedPotion.networks[networkId].address;\nvar raffleAddress = Raffle.networks[networkId].address;\nvar ebisusAddress = \"0x7a3CdB2364f92369a602CAE81167d0679087e6a3\";\nvar ebisusAbi = [\"function makePurchase(uint256 _id) public payable\"]; //const ContractAddress = CroSkulls.networks[networkId].address;\n\nvar connectRequest = function connectRequest() {\n  return {\n    type: \"CONNECTION_REQUEST\"\n  };\n};\n\nvar cleanBlockchain = function cleanBlockchain() {\n  return {\n    type: \"CLEAN_BLOCKCHAIN\"\n  };\n};\n\nvar connectSuccess = function connectSuccess(payload) {\n  return {\n    type: \"CONNECTION_SUCCESS\",\n    payload: payload\n  };\n};\n\nvar connectFailed = function connectFailed(payload) {\n  return {\n    type: \"CONNECTION_FAILED\",\n    payload: payload\n  };\n};\n\nvar updateAccountRequest = function updateAccountRequest(payload) {\n  return {\n    type: \"UPDATE_ACCOUNT\",\n    payload: payload\n  };\n};\n\nvar contractNotDetected = function contractNotDetected() {\n  return {\n    type: \"CONTRACT_NOT_DETECTED\"\n  };\n};\n\nvar noAccount = function noAccount() {\n  return {\n    type: \"CONTRACT_NOT_DETECTED\"\n  };\n};\n\nvar requestDisconnect = function requestDisconnect() {\n  return {\n    type: \"DISCONNECT\"\n  };\n};\n\nexport var wishboneError = function wishboneError() {\n  sendNotification({\n    title: \"Error\",\n    message: \"Wishbones must be a multiple of 10\",\n    type: \"error\"\n  });\n};\nexport var disconnect = function disconnect() {\n  return /*#__PURE__*/function () {\n    var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(dispatch) {\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              dispatch(requestDisconnect());\n              dispatch(cleanData());\n\n            case 2:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n\n    return function (_x) {\n      return _ref.apply(this, arguments);\n    };\n  }();\n};\nexport var connect = function connect() {\n  var ethProvider = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;\n  return /*#__PURE__*/function () {\n    var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2(dispatch) {\n      var signer, croSkullsContract, croSkullsStaking, croSkullsGrave, croPotionBlue, croPotionRed, croSkullsDescription, croSkullsPetEggs, croSkullsSouls, croRaffle, ebisusMarketplace, accounts, accountAddress, accountBalance;\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              dispatch(connectRequest());\n\n              if (ethProvider) {\n                _context2.next = 7;\n                break;\n              }\n\n              _context2.next = 4;\n              return ethers.getDefaultProvider('https://gateway.nebkas.ro');\n\n            case 4:\n              ethProvider = _context2.sent;\n              _context2.next = 7;\n              return ethProvider.getNetwork();\n\n            case 7:\n              dispatch(handleProviderChanges(ethProvider));\n\n              if (!(ethProvider.provider.chainId == chainId || ethProvider.provider.chainId == networkId)) {\n                _context2.next = 38;\n                break;\n              }\n\n              signer = ethProvider.getSigner();\n              croSkullsContract = new ethers.Contract(ContractAddress, CroSkulls.abi, signer ? signer : false);\n              croSkullsStaking = new ethers.Contract(stakingAddress, StakingArtifacts.abi, signer ? signer : false);\n              croSkullsGrave = new ethers.Contract(graveAddress, Grave.abi, signer ? signer : false);\n              croPotionBlue = new ethers.Contract(blueAddress, BluePotion.abi, signer ? signer : false);\n              croPotionRed = new ethers.Contract(redAddress, RedPotion.abi, signer ? signer : false); //let croSkullsDescription = ''\n\n              croSkullsDescription = new ethers.Contract(descriptionAddress, Description.abi, signer ? signer : false);\n              croSkullsPetEggs = new ethers.Contract(petEggsAddress, PetEggs.abi, signer ? signer : false);\n              croSkullsSouls = new ethers.Contract(soulsAddress, Souls.abi, signer ? signer : false);\n              croRaffle = new ethers.Contract(raffleAddress, Raffle.abi, signer ? signer : false);\n              ebisusMarketplace = new ethers.Contract(ebisusAddress, ebisusAbi, signer ? signer : false);\n              _context2.next = 22;\n              return ethProvider.provider.request({\n                method: 'eth_accounts'\n              });\n\n            case 22:\n              accounts = _context2.sent;\n\n              if (!(accounts.length === 0)) {\n                _context2.next = 27;\n                break;\n              }\n\n              dispatch(noAccount());\n              _context2.next = 36;\n              break;\n\n            case 27:\n              accountAddress = accounts[0];\n              dispatch(sendNotification({\n                title: \"Welcome Back\",\n                message: \"\".concat(accountAddress),\n                type: \"default\"\n              }));\n              _context2.next = 31;\n              return ethProvider.getBalance(accountAddress);\n\n            case 31:\n              _context2.next = 33;\n              return _context2.sent.toString();\n\n            case 33:\n              accountBalance = _context2.sent;\n              dispatch(connectSuccess({\n                accountAddress: accountAddress,\n                accountBalance: accountBalance,\n                ethProvider: ethProvider,\n                croSkullsContract: croSkullsContract,\n                croSkullsStaking: croSkullsStaking,\n                croSkullsGrave: croSkullsGrave,\n                croSkullsDescription: croSkullsDescription,\n                croSkullsPetEggs: croSkullsPetEggs,\n                croSkullsSouls: croSkullsSouls,\n                croPotionBlue: croPotionBlue,\n                croPotionRed: croPotionRed,\n                croRaffle: croRaffle,\n                ebisusMarketplace: ebisusMarketplace\n              }));\n              dispatch(getSkullsData());\n\n            case 36:\n              _context2.next = 40;\n              break;\n\n            case 38:\n              dispatch(contractNotDetected());\n              ethProvider.provider.request({\n                \"id\": 1,\n                \"jsonrpc\": \"2.0\",\n                \"method\": \"wallet_switchEthereumChain\",\n                \"params\": [{\n                  \"chainId\": chainId\n                }]\n              });\n\n            case 40:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2);\n    }));\n\n    return function (_x2) {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n};\nexport var handleProviderChanges = function handleProviderChanges(ethProvider) {\n  return /*#__PURE__*/function () {\n    var _ref3 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee3(dispatch) {\n      return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n        while (1) {\n          switch (_context3.prev = _context3.next) {\n            case 0:\n              ethProvider.provider.on('accountsChanged', function (accounts) {\n                dispatch(cleanData());\n                dispatch(connect(ethProvider));\n              });\n              ethProvider.provider.on('chainChanged', function (_chainId) {\n                dispatch(connect(ethProvider));\n              });\n\n            case 2:\n            case \"end\":\n              return _context3.stop();\n          }\n        }\n      }, _callee3);\n    }));\n\n    return function (_x3) {\n      return _ref3.apply(this, arguments);\n    };\n  }();\n};","map":{"version":3,"sources":["F:/Mattia/Visual studio/AppCroskull/croskull-nft-marketplace/src/redux/blockchain/blockchainActions.js"],"names":["ethers","CroSkullsAmbassador","CroSkulls","StakingArtifacts","Grave","Description","BluePotion","RedPotion","PetEggs","Souls","Raffle","sendNotification","getSkullsData","cleanData","chainId","networkId","stakingAddress","networks","address","graveAddress","ContractAddress","descriptionAddress","petEggsAddress","soulsAddress","blueAddress","redAddress","raffleAddress","ebisusAddress","ebisusAbi","connectRequest","type","cleanBlockchain","connectSuccess","payload","connectFailed","updateAccountRequest","contractNotDetected","noAccount","requestDisconnect","wishboneError","title","message","disconnect","dispatch","connect","ethProvider","getDefaultProvider","getNetwork","handleProviderChanges","provider","signer","getSigner","croSkullsContract","Contract","abi","croSkullsStaking","croSkullsGrave","croPotionBlue","croPotionRed","croSkullsDescription","croSkullsPetEggs","croSkullsSouls","croRaffle","ebisusMarketplace","request","method","accounts","length","accountAddress","getBalance","toString","accountBalance","on","_chainId"],"mappings":"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","sourcesContent":["// constants\r\nimport {\r\n    ethers\r\n} from 'ethers';\r\n// log\r\nimport CroSkullsAmbassador from \"../../abis/CroSkullsAmbassador.json\";\r\nimport CroSkulls from \"../../abis/CroSkulls.json\";\r\nimport StakingArtifacts from \"../../abis/croSkullStaking.json\";\r\nimport Grave from \"../../abis/Grave.json\";\r\nimport Description from \"../../abis/nftDescription.json\";\r\nimport BluePotion from \"../../abis/CroSkullsBluePotions.json\";\r\nimport RedPotion from \"../../abis/CroSkullsRedPotions.json\";\r\nimport PetEggs from \"../../abis/petEggs.json\";\r\nimport Souls from \"../../abis/Souls.json\";\r\nimport Raffle from \"../../abis/SkullsRaffle.json\";\r\nimport {\r\n  sendNotification, getSkullsData, cleanData\r\n} from \"../data/dataActions\";\r\nconst chainId =  \"0x19\" || \"0x152\"; //testnet - 3\r\nconst networkId =  25; //338 || 5777; //25 production, 339 cassini, 5777 ganache local env\r\nconst stakingAddress = StakingArtifacts.networks[networkId].address;\r\nconst graveAddress = Grave.networks[networkId].address;\r\nconst ContractAddress = CroSkulls.networks[networkId].address;\r\nconst descriptionAddress = Description.networks[networkId].address;\r\nconst petEggsAddress = PetEggs.networks[networkId].address;\r\nconst soulsAddress = Souls.networks[networkId].address;\r\nconst blueAddress = BluePotion.networks[networkId].address;\r\nconst redAddress = RedPotion.networks[networkId].address;\r\nconst raffleAddress = Raffle.networks[networkId].address;\r\nconst ebisusAddress = \"0x7a3CdB2364f92369a602CAE81167d0679087e6a3\";\r\n\r\nconst ebisusAbi = [\r\n    \"function makePurchase(uint256 _id) public payable\"\r\n];\r\n\r\n//const ContractAddress = CroSkulls.networks[networkId].address;\r\n\r\nconst connectRequest = () => {\r\n    return {\r\n        type: \"CONNECTION_REQUEST\",\r\n    };\r\n};\r\n\r\nconst cleanBlockchain = () => {\r\n    return {\r\n        type: \"CLEAN_BLOCKCHAIN\",\r\n    };\r\n}\r\n\r\nconst connectSuccess = (payload) => {\r\n    return {\r\n        type: \"CONNECTION_SUCCESS\",\r\n        payload: payload,\r\n    };\r\n};\r\n\r\nconst connectFailed = (payload) => {\r\n    return {\r\n        type: \"CONNECTION_FAILED\",\r\n        payload: payload,\r\n    };\r\n};\r\n\r\nconst updateAccountRequest = (payload) => {\r\n    return {\r\n        type: \"UPDATE_ACCOUNT\",\r\n        payload: payload,\r\n    }\r\n}\r\n\r\nconst contractNotDetected = () => {\r\n    return {\r\n        type: \"CONTRACT_NOT_DETECTED\"\r\n    }\r\n}\r\n\r\nconst noAccount = () => {\r\n    return {\r\n        type: \"CONTRACT_NOT_DETECTED\"\r\n    }\r\n}\r\n\r\nconst requestDisconnect = () => {\r\n    return {\r\n        type: \"DISCONNECT\"\r\n    }\r\n}\r\n\r\nexport const wishboneError = () => {\r\n    sendNotification({\r\n        title: `Error`,\r\n        message: `Wishbones must be a multiple of 10`,\r\n        type: \"error\"\r\n    })\r\n}\r\n\r\nexport const disconnect = () => {\r\n    return async (dispatch) => {\r\n        dispatch(requestDisconnect())\r\n        dispatch(cleanData())\r\n    }\r\n}\r\n\r\nexport const connect = ( ethProvider = false) => {\r\n    return async (dispatch) => {\r\n        dispatch(connectRequest());\r\n        if( ! ethProvider ){\r\n            ethProvider = await ethers.getDefaultProvider('https://gateway.nebkas.ro')\r\n            await ethProvider.getNetwork()\r\n        }\r\n        dispatch(handleProviderChanges(ethProvider))\r\n        if (ethProvider.provider.chainId == chainId || ethProvider.provider.chainId == networkId ) {\r\n            let signer = ethProvider.getSigner()\r\n            let croSkullsContract = new ethers.Contract(ContractAddress, CroSkulls.abi, signer ? signer : false )\r\n            let croSkullsStaking = new ethers.Contract(stakingAddress, StakingArtifacts.abi, signer ? signer : false )\r\n            let croSkullsGrave = new ethers.Contract(graveAddress, Grave.abi, signer ? signer : false )\r\n            let croPotionBlue = new ethers.Contract(blueAddress, BluePotion.abi, signer ? signer : false )\r\n            let croPotionRed = new ethers.Contract(redAddress, RedPotion.abi, signer ? signer : false )\r\n            //let croSkullsDescription = ''\r\n            let croSkullsDescription = new ethers.Contract(descriptionAddress, Description.abi, signer ? signer : false )\r\n            let croSkullsPetEggs = new ethers.Contract(petEggsAddress, PetEggs.abi, signer ? signer : false )\r\n            let croSkullsSouls = new ethers.Contract(soulsAddress, Souls.abi, signer ? signer : false )\r\n            let croRaffle = new ethers.Contract(raffleAddress, Raffle.abi, signer ? signer : false )\r\n            let ebisusMarketplace = new ethers.Contract(ebisusAddress, ebisusAbi, signer ? signer : false )\r\n            let accounts = await ethProvider.provider.request({\r\n                method: 'eth_accounts',\r\n            })\r\n            \r\n            if (accounts.length === 0) {\r\n                dispatch(noAccount())\r\n            } else {\r\n                let accountAddress = accounts[0]\r\n                dispatch(sendNotification({\r\n                    title: `Welcome Back`,\r\n                    message: `${accountAddress}`,\r\n                    type: \"default\"\r\n                }))\r\n                let accountBalance = await ( await ethProvider.getBalance(accountAddress)).toString();\r\n                dispatch(connectSuccess({\r\n                    accountAddress,\r\n                    accountBalance,\r\n                    ethProvider,\r\n                    croSkullsContract,\r\n                    croSkullsStaking,\r\n                    croSkullsGrave,\r\n                    croSkullsDescription,\r\n                    croSkullsPetEggs,\r\n                    croSkullsSouls,\r\n                    croPotionBlue,\r\n                    croPotionRed,\r\n                    croRaffle,\r\n                    ebisusMarketplace\r\n                }))\r\n                dispatch(getSkullsData())\r\n            }\r\n            //await this.loadBlockchainData()\r\n        } else {\r\n            dispatch(contractNotDetected())\r\n            ethProvider.provider.request({\r\n                \"id\": 1,\r\n                \"jsonrpc\": \"2.0\",\r\n                \"method\": \"wallet_switchEthereumChain\",\r\n                \"params\": [\r\n                  {\r\n                    \"chainId\": chainId,\r\n                  }\r\n                ]\r\n            })\r\n        }\r\n    }\r\n}\r\n\r\nexport const handleProviderChanges = (ethProvider) => {\r\n    return async (dispatch) => {\r\n        ethProvider.provider.on( 'accountsChanged', (accounts) => {\r\n            dispatch(cleanData())\r\n            dispatch(connect(ethProvider))\r\n        })\r\n        ethProvider.provider.on( 'chainChanged', (_chainId) => {\r\n                dispatch(connect(ethProvider))\r\n        })\r\n    }\r\n}"]},"metadata":{},"sourceType":"module"}