{"ast":null,"code":"import _regeneratorRuntime from \"F:\\\\Mattia\\\\Visual studio\\\\AppCroskull\\\\croskull-nft-marketplace\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/regenerator\";\nimport _asyncToGenerator from \"F:\\\\Mattia\\\\Visual studio\\\\AppCroskull\\\\croskull-nft-marketplace\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";\n// constants\nimport { ethers } from 'ethers'; // log\n\nimport CroSkullsAmbassador from \"../../abis/CroSkullsAmbassador.json\";\nimport CroSkulls from \"../../abis/CroSkulls.json\";\nimport StakingArtifacts from \"../../abis/croSkullStaking.json\";\nimport Grave from \"../../abis/Grave.json\";\nimport Description from \"../../abis/nftDescription.json\";\nimport BluePotion from \"../../abis/CroSkullsBluePotions.json\";\nimport RedPotion from \"../../abis/CroSkullsRedPotions.json\";\nimport PetEggs from \"../../abis/petEggs.json\";\nimport Souls from \"../../abis/Souls.json\";\nimport { sendNotification, getSkullsData, cleanData } from \"../data/dataActions\";\nvar chainId = \"0x19\" || \"0x152\"; //testnet - 3\n\nvar networkId = 25; //338 || 5777; //25 production, 339 cassini, 5777 ganache local env\n\nvar stakingAddress = StakingArtifacts.networks[networkId].address;\nvar graveAddress = Grave.networks[networkId].address;\nvar ContractAddress = CroSkulls.networks[networkId].address;\nvar descriptionAddress = Description.networks[networkId].address;\nvar petEggsAddress = PetEggs.networks[networkId].address;\nvar soulsAddress = Souls.networks[networkId].address;\nvar blueAddress = BluePotion.networks[networkId].address;\nvar redAddress = RedPotion.networks[networkId].address; //const ContractAddress = CroSkulls.networks[networkId].address;\n\nvar connectRequest = function connectRequest() {\n  return {\n    type: \"CONNECTION_REQUEST\"\n  };\n};\n\nvar cleanBlockchain = function cleanBlockchain() {\n  return {\n    type: \"CLEAN_BLOCKCHAIN\"\n  };\n};\n\nvar connectSuccess = function connectSuccess(payload) {\n  return {\n    type: \"CONNECTION_SUCCESS\",\n    payload: payload\n  };\n};\n\nvar connectFailed = function connectFailed(payload) {\n  return {\n    type: \"CONNECTION_FAILED\",\n    payload: payload\n  };\n};\n\nvar updateAccountRequest = function updateAccountRequest(payload) {\n  return {\n    type: \"UPDATE_ACCOUNT\",\n    payload: payload\n  };\n};\n\nvar contractNotDetected = function contractNotDetected() {\n  return {\n    type: \"CONTRACT_NOT_DETECTED\"\n  };\n};\n\nvar noAccount = function noAccount() {\n  return {\n    type: \"CONTRACT_NOT_DETECTED\"\n  };\n};\n\nvar requestDisconnect = function requestDisconnect() {\n  return {\n    type: \"DISCONNECT\"\n  };\n};\n\nexport var disconnect = function disconnect() {\n  return /*#__PURE__*/function () {\n    var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(dispatch) {\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              dispatch(requestDisconnect());\n              dispatch(cleanData());\n\n            case 2:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n\n    return function (_x) {\n      return _ref.apply(this, arguments);\n    };\n  }();\n};\nexport var connect = function connect() {\n  var _provider = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;\n\n  var newChainId = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n  return /*#__PURE__*/function () {\n    var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2(dispatch) {\n      var provider, ethProvider, signer, croSkullsContract, croSkullsStaking, croSkullsGrave, croPotionBlue, croPotionRed, croSkullsDescription, croSkullsPetEggs, croSkullsSouls, accounts, accountAddress, accountBalance;\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              dispatch(connectRequest());\n\n              if (_provider) {\n                provider = _provider;\n              } else if (!_provider) {\n                provider = window.ethereum;\n                dispatch(handleProviderChanges(provider));\n              }\n\n              ethProvider = new ethers.providers.Web3Provider(provider, \"any\");\n              console.log(ethProvider);\n\n              if (!(provider.chainId == chainId || provider.chainId == networkId)) {\n                _context2.next = 32;\n                break;\n              }\n\n              signer = ethProvider.getSigner(0);\n              croSkullsContract = new ethers.Contract(ContractAddress, CroSkulls.abi, signer);\n              croSkullsStaking = new ethers.Contract(stakingAddress, StakingArtifacts.abi, signer);\n              croSkullsGrave = new ethers.Contract(graveAddress, Grave.abi, signer);\n              croPotionBlue = new ethers.Contract(blueAddress, BluePotion.abi, signer);\n              croPotionRed = new ethers.Contract(redAddress, RedPotion.abi, signer); //let croSkullsDescription = ''\n\n              croSkullsDescription = new ethers.Contract(descriptionAddress, Description.abi, signer);\n              croSkullsPetEggs = new ethers.Contract(petEggsAddress, PetEggs.abi, signer);\n              croSkullsSouls = new ethers.Contract(soulsAddress, Souls.abi, signer);\n              _context2.next = 16;\n              return provider.request({\n                method: 'eth_accounts'\n              });\n\n            case 16:\n              accounts = _context2.sent;\n\n              if (!(accounts.length === 0)) {\n                _context2.next = 21;\n                break;\n              }\n\n              dispatch(noAccount());\n              _context2.next = 30;\n              break;\n\n            case 21:\n              accountAddress = accounts[0];\n              dispatch(sendNotification({\n                title: \"Welcome Back\",\n                message: \"\".concat(accountAddress),\n                type: \"default\"\n              }));\n              _context2.next = 25;\n              return ethProvider.getBalance(accountAddress);\n\n            case 25:\n              _context2.next = 27;\n              return _context2.sent.toString();\n\n            case 27:\n              accountBalance = _context2.sent;\n              dispatch(connectSuccess({\n                accountAddress: accountAddress,\n                accountBalance: accountBalance,\n                ethProvider: ethProvider,\n                provider: provider,\n                croSkullsContract: croSkullsContract,\n                croSkullsStaking: croSkullsStaking,\n                croSkullsGrave: croSkullsGrave,\n                croSkullsDescription: croSkullsDescription,\n                croSkullsPetEggs: croSkullsPetEggs,\n                croSkullsSouls: croSkullsSouls,\n                croPotionBlue: croPotionBlue,\n                croPotionRed: croPotionRed\n              }));\n              dispatch(getSkullsData());\n\n            case 30:\n              _context2.next = 34;\n              break;\n\n            case 32:\n              dispatch(contractNotDetected());\n              provider.request({\n                \"id\": 1,\n                \"jsonrpc\": \"2.0\",\n                \"method\": \"wallet_switchEthereumChain\",\n                \"params\": [{\n                  \"chainId\": chainId\n                }]\n              });\n\n            case 34:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2);\n    }));\n\n    return function (_x2) {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n};\nexport var handleProviderChanges = function handleProviderChanges(provider) {\n  return /*#__PURE__*/function () {\n    var _ref3 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee3(dispatch) {\n      return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n        while (1) {\n          switch (_context3.prev = _context3.next) {\n            case 0:\n              provider.on('accountsChanged', function (accounts) {\n                dispatch(cleanData());\n                dispatch(connect());\n              });\n              provider.on('chainChanged', function (_chainId) {\n                dispatch(connect(provider));\n              });\n\n            case 2:\n            case \"end\":\n              return _context3.stop();\n          }\n        }\n      }, _callee3);\n    }));\n\n    return function (_x3) {\n      return _ref3.apply(this, arguments);\n    };\n  }();\n};","map":{"version":3,"sources":["F:/Mattia/Visual studio/AppCroskull/croskull-nft-marketplace/src/redux/blockchain/blockchainActions.js"],"names":["ethers","CroSkullsAmbassador","CroSkulls","StakingArtifacts","Grave","Description","BluePotion","RedPotion","PetEggs","Souls","sendNotification","getSkullsData","cleanData","chainId","networkId","stakingAddress","networks","address","graveAddress","ContractAddress","descriptionAddress","petEggsAddress","soulsAddress","blueAddress","redAddress","connectRequest","type","cleanBlockchain","connectSuccess","payload","connectFailed","updateAccountRequest","contractNotDetected","noAccount","requestDisconnect","disconnect","dispatch","connect","_provider","newChainId","provider","window","ethereum","handleProviderChanges","ethProvider","providers","Web3Provider","console","log","signer","getSigner","croSkullsContract","Contract","abi","croSkullsStaking","croSkullsGrave","croPotionBlue","croPotionRed","croSkullsDescription","croSkullsPetEggs","croSkullsSouls","request","method","accounts","length","accountAddress","title","message","getBalance","toString","accountBalance","on","_chainId"],"mappings":"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","sourcesContent":["// constants\r\nimport {\r\n    ethers\r\n} from 'ethers';\r\n// log\r\nimport CroSkullsAmbassador from \"../../abis/CroSkullsAmbassador.json\";\r\nimport CroSkulls from \"../../abis/CroSkulls.json\";\r\nimport StakingArtifacts from \"../../abis/croSkullStaking.json\";\r\nimport Grave from \"../../abis/Grave.json\";\r\nimport Description from \"../../abis/nftDescription.json\";\r\nimport BluePotion from \"../../abis/CroSkullsBluePotions.json\";\r\nimport RedPotion from \"../../abis/CroSkullsRedPotions.json\";\r\nimport PetEggs from \"../../abis/petEggs.json\";\r\nimport Souls from \"../../abis/Souls.json\";\r\nimport {\r\n  sendNotification, getSkullsData, cleanData\r\n} from \"../data/dataActions\";\r\nconst chainId =  \"0x19\" || \"0x152\"; //testnet - 3\r\nconst networkId =  25; //338 || 5777; //25 production, 339 cassini, 5777 ganache local env\r\nconst stakingAddress = StakingArtifacts.networks[networkId].address;\r\nconst graveAddress = Grave.networks[networkId].address;\r\nconst ContractAddress = CroSkulls.networks[networkId].address;\r\nconst descriptionAddress = Description.networks[networkId].address;\r\nconst petEggsAddress = PetEggs.networks[networkId].address;\r\nconst soulsAddress = Souls.networks[networkId].address;\r\nconst blueAddress = BluePotion.networks[networkId].address;\r\nconst redAddress = RedPotion.networks[networkId].address;\r\n\r\n//const ContractAddress = CroSkulls.networks[networkId].address;\r\n\r\nconst connectRequest = () => {\r\n    return {\r\n        type: \"CONNECTION_REQUEST\",\r\n    };\r\n};\r\n\r\nconst cleanBlockchain = () => {\r\n    return {\r\n        type: \"CLEAN_BLOCKCHAIN\",\r\n    };\r\n}\r\n\r\nconst connectSuccess = (payload) => {\r\n    return {\r\n        type: \"CONNECTION_SUCCESS\",\r\n        payload: payload,\r\n    };\r\n};\r\n\r\nconst connectFailed = (payload) => {\r\n    return {\r\n        type: \"CONNECTION_FAILED\",\r\n        payload: payload,\r\n    };\r\n};\r\n\r\nconst updateAccountRequest = (payload) => {\r\n    return {\r\n        type: \"UPDATE_ACCOUNT\",\r\n        payload: payload,\r\n    }\r\n}\r\n\r\nconst contractNotDetected = () => {\r\n    return {\r\n        type: \"CONTRACT_NOT_DETECTED\"\r\n    }\r\n}\r\n\r\nconst noAccount = () => {\r\n    return {\r\n        type: \"CONTRACT_NOT_DETECTED\"\r\n    }\r\n}\r\n\r\nconst requestDisconnect = () => {\r\n    return {\r\n        type: \"DISCONNECT\"\r\n    }\r\n}\r\n\r\nexport const disconnect = () => {\r\n    return async (dispatch) => {\r\n        dispatch(requestDisconnect())\r\n        dispatch(cleanData())\r\n    }\r\n}\r\n\r\nexport const connect = (_provider = false, newChainId = false) => {\r\n    return async (dispatch) => {\r\n        dispatch(connectRequest());\r\n        let provider;\r\n\r\n        if (_provider) {\r\n            provider = _provider;\r\n        } else if (!_provider) {\r\n            provider = window.ethereum\r\n            dispatch(handleProviderChanges(provider))\r\n        }\r\n\r\n        let ethProvider = new ethers.providers.Web3Provider(provider, \"any\");\r\n        console.log( ethProvider )\r\n        if (provider.chainId == chainId || provider.chainId == networkId ) {\r\n            let signer = ethProvider.getSigner(0)\r\n            let croSkullsContract = new ethers.Contract(ContractAddress, CroSkulls.abi, signer)\r\n            let croSkullsStaking = new ethers.Contract(stakingAddress, StakingArtifacts.abi, signer)\r\n            let croSkullsGrave = new ethers.Contract(graveAddress, Grave.abi, signer)\r\n            let croPotionBlue = new ethers.Contract(blueAddress, BluePotion.abi, signer)\r\n            let croPotionRed = new ethers.Contract(redAddress, RedPotion.abi, signer)\r\n            //let croSkullsDescription = ''\r\n            let croSkullsDescription = new ethers.Contract(descriptionAddress, Description.abi, signer)\r\n            let croSkullsPetEggs = new ethers.Contract(petEggsAddress, PetEggs.abi, signer)\r\n            let croSkullsSouls = new ethers.Contract(soulsAddress, Souls.abi, signer)\r\n            let accounts = await provider.request({\r\n                method: 'eth_accounts',\r\n            })\r\n            \r\n            if (accounts.length === 0) {\r\n                dispatch(noAccount())\r\n            } else {\r\n                let accountAddress = accounts[0]\r\n                dispatch(sendNotification({\r\n                    title: `Welcome Back`,\r\n                    message: `${accountAddress}`,\r\n                    type: \"default\"\r\n                }))\r\n                let accountBalance = await ( await ethProvider.getBalance(accountAddress)).toString();\r\n                dispatch(connectSuccess({\r\n                    accountAddress,\r\n                    accountBalance,\r\n                    ethProvider,\r\n                    provider,\r\n                    croSkullsContract,\r\n                    croSkullsStaking,\r\n                    croSkullsGrave,\r\n                    croSkullsDescription,\r\n                    croSkullsPetEggs,\r\n                    croSkullsSouls,\r\n                    croPotionBlue,\r\n                    croPotionRed\r\n                }))\r\n                dispatch(getSkullsData())\r\n            }\r\n            //await this.loadBlockchainData()\r\n        } else {\r\n            dispatch(contractNotDetected())\r\n            provider.request({\r\n                \"id\": 1,\r\n                \"jsonrpc\": \"2.0\",\r\n                \"method\": \"wallet_switchEthereumChain\",\r\n                \"params\": [\r\n                  {\r\n                    \"chainId\": chainId,\r\n                  }\r\n                ]\r\n            })\r\n        }\r\n    }\r\n}\r\n\r\nexport const handleProviderChanges = (provider) => {\r\n    return async (dispatch) => {\r\n        provider.on( 'accountsChanged', (accounts) => {\r\n            dispatch(cleanData())\r\n            dispatch(connect())\r\n        })\r\n        provider.on( 'chainChanged', (_chainId) => {\r\n                dispatch(connect(provider))\r\n        })\r\n    }\r\n}"]},"metadata":{},"sourceType":"module"}